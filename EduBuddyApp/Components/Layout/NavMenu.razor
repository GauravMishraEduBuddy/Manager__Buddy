@using Microsoft.AspNetCore.Components.Authorization
@using EduBuddyApp.Services
@inject Services.IAuthService AuthService
@inject NavigationManager Nav
@inject UserState UserState

<div class="top-row ps-3 navbar navbar-dark">
    <div class="container-fluid">
        <a class="navbar-brand" href="">Manager Buddy</a>
    </div>
</div>

<input type="checkbox" title="Navigation menu" class="navbar-toggler" />

<div class="nav-scrollable sidebar-menu" onclick="document.querySelector('.navbar-toggler').click()">
    <RadzenPanelMenu Style="width: 100%">
        <RadzenPanelMenuItem Text="Home" Icon="home" Path="/home" />
        
        <RadzenPanelMenuItem Text="Management" Icon="business_center" Path="#">
            <RadzenPanelMenuItem Text="Dashboard" Icon="dashboard" Path="#" Style="pointer-events: none; opacity: 0.5;" />
            <RadzenPanelMenuItem Text="Reports" Icon="assessment" Path="#" Style="pointer-events: none; opacity: 0.5;" />
            <RadzenPanelMenuItem Text="Analytics" Icon="analytics" Path="#" Style="pointer-events: none; opacity: 0.5;" />
        </RadzenPanelMenuItem>
        
        <RadzenPanelMenuItem Text="Settings" Icon="settings" Path="#">
            <RadzenPanelMenuItem Text="Preferences" Icon="tune" Path="#" Style="pointer-events: none; opacity: 0.5;" />
            <RadzenPanelMenuItem Text="Configuration" Icon="build" Path="#" Style="pointer-events: none; opacity: 0.5;" />
        </RadzenPanelMenuItem>
    </RadzenPanelMenu>
    
    <AuthorizeView>
        <Authorized>
            <div class="nav-item px-3 mt-auto">
                <a @onclick="DoLogout" style="cursor:pointer" class="logout-link">
                    <RadzenIcon Icon="logout" Style="margin-right: 0.5rem;" />
                    Logout
                </a>
            </div>
        </Authorized>
        <NotAuthorized>
            <div class="nav-item px-3">
                <NavLink href="login" class="login-link">
                    <RadzenIcon Icon="login" Style="margin-right: 0.5rem;" />
                    Login
                </NavLink>
            </div>
        </NotAuthorized>
    </AuthorizeView>
</div>

<style>
    .logout-link, .login-link {
        display: flex;
        align-items: center;
        color: #fff;
        text-decoration: none;
        padding: 0.75rem 1rem;
        border-radius: 0.375rem;
        transition: background-color 0.3s ease;
    }
    
    .logout-link:hover, .login-link:hover {
        background-color: rgba(255, 255, 255, 0.1);
        color: #fff;
        text-decoration: none;
    }
</style>

@code {
    async Task DoLogout()
    {
        await AuthService.LogoutAsync();
        UserState.EmployeeId = null;
        UserState.FacilityStatuses.Clear();
        Nav.NavigateTo("", true);
    }
}